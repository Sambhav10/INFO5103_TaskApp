{% extends 'base.html' %}
{% block title %}Create New Task{% endblock %}

{% block content %}

<h2>Create a New Task</h2>

<!-- Display error messages -->
{% if error_messages %}
<div class="alert alert-danger" role="alert">
  <ul>
    {% for error in error_messages %}
    <li>{{ error }}</li>
    {% endfor %}
  </ul>
</div>
{% endif %}

<!-- Display success messages -->
{% if success_messages %}
<div class="alert alert-success" role="alert">
  <ul>
    {% for success in success_messages %}
    <li>{{ success }}</li>
    {% endfor %}
  </ul>
</div>
{% endif %}

<form action="{{ url_for('task.new_task') }}" method="POST">
  <div class="form-group">
    <label for="title">Task Title</label>
    <input
      type="text"
      class="form-control"
      id="title"
      name="title"
      placeholder="Enter task title"
      required
    />
  </div>

  <div class="form-group">
    <label for="description">Task Description</label>
    <textarea
      class="form-control"
      id="description"
      name="description"
      rows="4"
      placeholder="Enter task description"
      required
    ></textarea>
  </div>

  <div class="form-group">
    <label for="deadline">Task Deadline</label>
    <div class="input-group">
      <input
        type="text"
        class="form-control"
        id="deadline"
        name="deadline"
        placeholder="Select task deadline"
        required
      />
      <div class="input-group-append">
        <span class="input-group-text">
          <i class="fa fa-calendar"></i>
        </span>
      </div>
    </div>
  </div>

  <button type="submit" class="btn btn-primary">Create Task</button>
</form>

<!-- Include Flatpickr and FontAwesome from CDN -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<!-- Initialize Flatpickr -->
<script>
  flatpickr("#deadline", {
    dateFormat: "Y-m-d",  // Specify date format as YYYY-MM-DD
    minDate: "today",     // Disable past dates
    enableTime: false,    // Disable time selection
  });

  // Make the icon clickable to trigger the datepicker
  // didn't waana use query selector but couldn't find any other method
  document.querySelector('.input-group-text').addEventListener('click', function() {
    document.querySelector('#deadline')._flatpickr.open();
  });
</script>

{% endblock %}
